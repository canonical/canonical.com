name: Update PR Description with Demo Link

on:
  pull_request:
    types: [opened]

jobs:
  update-pr-description:
    runs-on: ubuntu-latest

    steps:
      - name: Update PR Description with Demo Link
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          pr_number="${{ github.event.pull_request.number }}"
          demo_link="https://canonical-com-${pr_number}.demos.haus/"
          
          # Fetch current PR body
          gh pr view "$pr_number" --json body -q .body > original_body.txt
          
          # Replace placeholder with actual demo link
          sed "s|\[demo link\]()|[demo link]($demo_link)|g" original_body.txt > updated_body.txt
          
          # Update PR with modified body
          gh pr edit "$pr_number" --body-file updated_body.txt
